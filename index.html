<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>Samia â€” Deen & Arabe ğŸŒ¸</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Amiri:ital,wght@0,400;0,700;1,400&family=Playfair+Display:ital,wght@0,500;0,700;1,500&family=DM+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <style>
        :root {
            --cream: #FDF8F3;
            --blush: #F9EEE8;
            --rose: #E8A4A4;
            --rose-dark: #C47A7A;
            --mauve: #B39DDB;
            --mauve-light: #EDE7F6;
            --sand: #D4B896;
            --text: #3D2B2B;
            --text-soft: #7A5C5C;
            --text-muted: #B08080;
            --card-bg: #FFFFFF;
            --border: #F0E0D6;
        }
        * { -webkit-tap-highlight-color: transparent; box-sizing: border-box; }
        body {
            font-family: 'DM Sans', sans-serif;
            background: var(--cream);
            background-image:
                radial-gradient(ellipse 80% 50% at 20% 0%, rgba(232,164,164,0.15) 0%, transparent 60%),
                radial-gradient(ellipse 60% 40% at 80% 100%, rgba(179,157,219,0.12) 0%, transparent 60%);
            color: var(--text);
            min-height: 100vh;
            overscroll-behavior-y: contain;
        }
        .amiri { font-family: 'Amiri', serif; }
        .playfair { font-family: 'Playfair Display', serif; }
        .card { background: var(--card-bg); border: 1px solid var(--border); border-radius: 20px; box-shadow: 0 2px 12px rgba(196,122,122,0.06); }
        .card-soft { background: var(--blush); border: 1px solid var(--border); border-radius: 20px; }
        .rose-btn { background: linear-gradient(135deg, #E8A4A4, #C47A7A); color: white; border-radius: 16px; font-weight: 700; box-shadow: 0 4px 16px rgba(196,122,122,0.3); }
        .pb-nav { padding-bottom: 7rem; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        input, textarea { font-size: 16px !important; }
        details summary::-webkit-details-marker { display: none; }

        .active-nav .nav-icon { color: #C47A7A; }
        .active-nav .nav-label { color: #C47A7A; }

        .toast-anim { animation: toastIn 0.3s ease; }
        @keyframes toastIn { from { opacity:0; transform: translate(-50%,-10px); } to { opacity:1; transform: translate(-50%,0); } }
        @keyframes fadeUp { from { opacity:0; transform:translateY(16px); } to { opacity:1; transform:translateY(0); } }
        .fade-up { animation: fadeUp 0.4s ease both; }

        .rating-btn { transition: all 0.15s ease; border: 1.5px solid var(--border); }
        #rate-easy.sel { background: #DCFCE7; border-color: #86EFAC; }
        #rate-medium.sel { background: #FEF9C3; border-color: #FDE047; }
        #rate-hard.sel { background: #FEE2E2; border-color: #FCA5A5; }
    </style>

    <script>
        // ============ DATA â€” localStorage ============
        let userData = {};
        let sessions = [];
        let scores = {};
        let personalDuas = [];
        const LS = 'samia-deen-v2';

        function loadAll() {
            try {
                const raw = localStorage.getItem(LS);
                if (raw) {
                    const d = JSON.parse(raw);
                    sessions = d.sessions || [];
                    scores = d.scores || {};
                    personalDuas = d.personalDuas || [];
                    userData = { streak: d.streak||0, lastSession: d.lastSession||null };
                }
            } catch(e) {}
        }

        function saveMain() {
            try {
                localStorage.setItem(LS, JSON.stringify({ sessions, scores, personalDuas, streak: userData.streak||0, lastSession: userData.lastSession||null }));
            } catch(e) {}
        }

        // ============ SURAHS ============
        const SURAHS = [
            { id:'fatiha', name:'Al-Fatiha', nameAr:'Ø§Ù„ÙØ§ØªØ­Ø©', level:1, emoji:'ğŸŒŸ', tip:`La plus rÃ©citÃ©e. Chaque lettre doit Ãªtre claire.`, verses:[{n:1,ar:'Ø¨ÙØ³Ù’Ù…Ù Ø§Ù„Ù„ÙÙ‘Ù‡Ù Ø§Ù„Ø±ÙÙ‘Ø­Ù’Ù…ÙÙ°Ù†Ù Ø§Ù„Ø±ÙÙ‘Ø­ÙÙŠÙ…Ù',tr:`Au nom d'Allah, le Tout MisÃ©ricordieux, le TrÃ¨s MisÃ©ricordieux`},{n:2,ar:'Ø§Ù„Ù’Ø­ÙÙ…Ù’Ø¯Ù Ù„ÙÙ„ÙÙ‘Ù‡Ù Ø±ÙØ¨ÙÙ‘ Ø§Ù„Ù’Ø¹ÙØ§Ù„ÙÙ…ÙÙŠÙ†Ù',tr:`Louange Ã  Allah, Seigneur des mondes`},{n:3,ar:'Ø§Ù„Ø±ÙÙ‘Ø­Ù’Ù…ÙÙ°Ù†Ù Ø§Ù„Ø±ÙÙ‘Ø­ÙÙŠÙ…Ù',tr:`Le Tout MisÃ©ricordieux, le TrÃ¨s MisÃ©ricordieux`},{n:4,ar:'Ù…ÙØ§Ù„ÙÙƒÙ ÙŠÙÙˆÙ’Ù…Ù Ø§Ù„Ø¯ÙÙ‘ÙŠÙ†Ù',tr:`MaÃ®tre du Jour de la rÃ©tribution`},{n:5,ar:'Ø¥ÙÙŠÙÙ‘Ø§ÙƒÙ Ù†ÙØ¹Ù’Ø¨ÙØ¯Ù ÙˆÙØ¥ÙÙŠÙÙ‘Ø§ÙƒÙ Ù†ÙØ³Ù’ØªÙØ¹ÙÙŠÙ†Ù',tr:`C'est Toi que nous adorons, et c'est Toi dont nous implorons le secours`},{n:6,ar:'Ø§Ù‡Ù’Ø¯ÙÙ†ÙØ§ Ø§Ù„ØµÙÙ‘Ø±ÙØ§Ø·Ù Ø§Ù„Ù’Ù…ÙØ³Ù’ØªÙÙ‚ÙÙŠÙ…Ù',tr:`Guide-nous dans le droit chemin`},{n:7,ar:'ØµÙØ±ÙØ§Ø·Ù Ø§Ù„ÙÙ‘Ø°ÙÙŠÙ†Ù Ø£ÙÙ†Ù’Ø¹ÙÙ…Ù’ØªÙ Ø¹ÙÙ„ÙÙŠÙ’Ù‡ÙÙ…Ù’ ØºÙÙŠÙ’Ø±Ù Ø§Ù„Ù’Ù…ÙØºÙ’Ø¶ÙÙˆØ¨Ù Ø¹ÙÙ„ÙÙŠÙ’Ù‡ÙÙ…Ù’ ÙˆÙÙ„ÙØ§ Ø§Ù„Ø¶ÙÙ‘Ø§Ù„ÙÙ‘ÙŠÙ†Ù',tr:`Le chemin de ceux que Tu as comblÃ©s de bienfaits, non pas de ceux qui ont encouru Ta colÃ¨re, ni des Ã©garÃ©s`}]},
            { id:'ikhlas', name:'Al-Ikhlas', nameAr:'Ø§Ù„Ø¥Ø®Ù„Ø§Øµ', level:1, emoji:'ğŸ’', tip:`Vaut 1/3 du Coran. Chaque mot compte.`, verses:[{n:1,ar:'Ù‚ÙÙ„Ù’ Ù‡ÙÙˆÙ Ø§Ù„Ù„ÙÙ‘Ù‡Ù Ø£ÙØ­ÙØ¯ÙŒ',tr:`Dis : Â«Il est Allah, l'UniqueÂ»`},{n:2,ar:'Ø§Ù„Ù„ÙÙ‘Ù‡Ù Ø§Ù„ØµÙÙ‘Ù…ÙØ¯Ù',tr:`Allah, le Seul Ã  Ãªtre implorÃ© pour ce que nous dÃ©sirons`},{n:3,ar:'Ù„ÙÙ…Ù’ ÙŠÙÙ„ÙØ¯Ù’ ÙˆÙÙ„ÙÙ…Ù’ ÙŠÙÙˆÙ„ÙØ¯Ù’',tr:`Il n'a pas engendrÃ©, n'a pas Ã©tÃ© engendrÃ© non plus`},{n:4,ar:'ÙˆÙÙ„ÙÙ…Ù’ ÙŠÙÙƒÙÙ† Ù„ÙÙ‘Ù‡Ù ÙƒÙÙÙÙˆÙ‹Ø§ Ø£ÙØ­ÙØ¯ÙŒ',tr:`Et nul n'est Ã©gal Ã  Lui`}]},
            { id:'falaq', name:'Al-Falaq', nameAr:'Ø§Ù„ÙÙ„Ù‚', level:1, emoji:'ğŸŒ…', tip:`Sourate de protection. Ã€ lire avec clartÃ©.`, verses:[{n:1,ar:'Ù‚ÙÙ„Ù’ Ø£ÙØ¹ÙÙˆØ°Ù Ø¨ÙØ±ÙØ¨ÙÙ‘ Ø§Ù„Ù’ÙÙÙ„ÙÙ‚Ù',tr:`Dis : Â«Je cherche protection auprÃ¨s du Seigneur de l'Aube naissanteÂ»`},{n:2,ar:'Ù…ÙÙ† Ø´ÙØ±ÙÙ‘ Ù…ÙØ§ Ø®ÙÙ„ÙÙ‚Ù',tr:`contre le mal de ce qu'Il a crÃ©Ã©`},{n:3,ar:'ÙˆÙÙ…ÙÙ† Ø´ÙØ±ÙÙ‘ ØºÙØ§Ø³ÙÙ‚Ù Ø¥ÙØ°ÙØ§ ÙˆÙÙ‚ÙØ¨Ù',tr:`et contre le mal de l'obscuritÃ© quand elle s'installe`},{n:4,ar:'ÙˆÙÙ…ÙÙ† Ø´ÙØ±ÙÙ‘ Ø§Ù„Ù†ÙÙ‘ÙÙÙ‘Ø§Ø«ÙØ§ØªÙ ÙÙÙŠ Ø§Ù„Ù’Ø¹ÙÙ‚ÙØ¯Ù',tr:`et contre le mal de celles qui soufflent sur les nÅ“uds`},{n:5,ar:'ÙˆÙÙ…ÙÙ† Ø´ÙØ±ÙÙ‘ Ø­ÙØ§Ø³ÙØ¯Ù Ø¥ÙØ°ÙØ§ Ø­ÙØ³ÙØ¯Ù',tr:`et contre le mal de l'envieux quand il envie`}]},
            { id:'nas', name:'An-Nas', nameAr:'Ø§Ù„Ù†Ø§Ø³', level:1, emoji:'ğŸ›¡ï¸', tip:`Ã€ rÃ©citer le soir pour la protection.`, verses:[{n:1,ar:'Ù‚ÙÙ„Ù’ Ø£ÙØ¹ÙÙˆØ°Ù Ø¨ÙØ±ÙØ¨ÙÙ‘ Ø§Ù„Ù†ÙÙ‘Ø§Ø³Ù',tr:`Dis : Â«Je cherche protection auprÃ¨s du Seigneur des hommesÂ»`},{n:2,ar:'Ù…ÙÙ„ÙÙƒÙ Ø§Ù„Ù†ÙÙ‘Ø§Ø³Ù',tr:`du Roi des hommes`},{n:3,ar:'Ø¥ÙÙ„ÙÙ°Ù‡Ù Ø§Ù„Ù†ÙÙ‘Ø§Ø³Ù',tr:`de Dieu des hommes`},{n:4,ar:'Ù…ÙÙ† Ø´ÙØ±ÙÙ‘ Ø§Ù„Ù’ÙˆÙØ³Ù’ÙˆÙØ§Ø³Ù Ø§Ù„Ù’Ø®ÙÙ†ÙÙ‘Ø§Ø³Ù',tr:`contre le mal du mauvais conseiller furtif`},{n:5,ar:'Ø§Ù„ÙÙ‘Ø°ÙÙŠ ÙŠÙÙˆÙØ³Ù’ÙˆÙØ³Ù ÙÙÙŠ ØµÙØ¯ÙÙˆØ±Ù Ø§Ù„Ù†ÙÙ‘Ø§Ø³Ù',tr:`qui souffle le mal dans les poitrines des hommes`},{n:6,ar:'Ù…ÙÙ†Ù Ø§Ù„Ù’Ø¬ÙÙ†ÙÙ‘Ø©Ù ÙˆÙØ§Ù„Ù†ÙÙ‘Ø§Ø³Ù',tr:`qu'il soit djinn ou Ãªtre humain`}]},
        ];

        // ============ PROPHETS (25 complets) ============
        const PROPHETS = [
            { name: "Adam ï·º", subtitle: "Le premier homme et prophÃ¨te", emoji: "ğŸŒ¿", story: `Adam est le premier Ãªtre humain et le premier prophÃ¨te. Allah l'a crÃ©Ã© de la terre, lui a insufflÃ© Son souffle et lui a enseignÃ© les noms de toutes choses.\n\nIl vivait au Paradis avec Ãˆve (Hawwa), mais le ShaytÃ¢n les a trompÃ©s. Allah leur a pardonnÃ© aprÃ¨s leur repentir sincÃ¨re, et les a envoyÃ©s sur terre comme Ses reprÃ©sentants.\n\nğŸ“¿ LeÃ§on : Allah pardonne toujours Ã  celui qui se repent sincÃ¨rement.` },
            { name: "IdrÃ®s ï·º", subtitle: "Le premier Ã  Ã©crire et Ã  coudre", emoji: "âœï¸", story: `IdrÃ®s est le premier Ã  avoir Ã©crit avec une plume et Ã  confectionner des vÃªtements cousus. Il Ã©tait dotÃ© d'une grande sagesse.\n\nAllah dit de lui : "Rappelle-toi IdrÃ®s dans le Livre. Il Ã©tait vÃ©ridique, prophÃ¨te."\n\nğŸ“¿ LeÃ§on : La connaissance, l'Ã©criture et le savoir utile sont nobles aux yeux d'Allah.` },
            { name: "NÃ»h ï·º", subtitle: "950 ans de patience, le DÃ©luge", emoji: "ğŸš¢", story: `NÃ»h a prÃªchÃ© son peuple pendant 950 ans. Son peuple adorait des idoles et refusait de l'Ã©couter.\n\nIl a construit l'Arche par ordre divin, et le Grand DÃ©luge a tout submergÃ© sauf ceux qui Ã©taient Ã  bord. MÃªme son fils a refusÃ© de monter.\n\nğŸ“¿ LeÃ§on : La guidance appartient Ã  Allah seul.` },
            { name: "HÃ»d ï·º", subtitle: "EnvoyÃ© au peuple de 'Ã‚d", emoji: "ğŸŒ¬ï¸", story: `HÃ»d fut envoyÃ© au puissant peuple de 'Ã‚d, des gÃ©ants qui s'enorgueillissaient de leur force physique.\n\nIls refusÃ¨rent le message avec arrogance. Ils furent dÃ©truits par un vent mugissant et furieux qui dura 7 nuits et 8 jours.\n\nğŸ“¿ LeÃ§on : L'arrogance mÃ¨ne Ã  la chute. La force physique ne protÃ¨ge de rien face Ã  Dieu.` },
            { name: "SÃ¢lih ï·º", subtitle: "La chamelle miraculeuse", emoji: "ğŸª", story: `SÃ¢lih fut envoyÃ© aux Thamoud, un peuple qui taillait des palais dans les montagnes.\n\nIls demandÃ¨rent un miracle : une chamelle sortant d'un rocher. Allah l'accorda, mais ils la tuÃ¨rent par bravade. Ils furent frappÃ©s par un cri terrible.\n\nğŸ“¿ LeÃ§on : Tester les limites d'Allah est l'erreur la plus dangereuse.` },
            { name: "IbrÃ¢hÃ®m ï·º", subtitle: "L'ami intime d'Allah", emoji: "ğŸ”¥", story: `Ibrahim est le "pÃ¨re des prophÃ¨tes". Il brisa les idoles de son peuple, fut jetÃ© dans un feu ardent, mais Allah ordonna au feu d'Ãªtre fraÃ®cheur et paix.\n\nL'Ã©preuve suprÃªme : Allah lui ordonna de sacrifier son fils IsmaÃ¯l. Tous deux acceptÃ¨rent â€” Allah remplaÃ§a IsmaÃ¯l par un bÃ©lier.\n\nğŸ“¿ LeÃ§on : La soumission totale Ã  Allah est illustrÃ©e par Ibrahim.` },
            { name: "LÃ»t ï·º", subtitle: "Neveu d'Ibrahim", emoji: "ğŸ™ï¸", story: `LÃ»t fut envoyÃ© aux habitants de Sodome, connus pour leurs crimes et leur dÃ©pravation extrÃªme.\n\nIl les prÃªcha pendant des annÃ©es mais ils refusÃ¨rent. Des anges vinrent dÃ©truire la ville. La femme de LÃ»t regarda en arriÃ¨re et fut chÃ¢tiÃ©e.\n\nğŸ“¿ LeÃ§on : Demeurer dans un environnement de corruption sans rÃ©sistance mÃ¨ne Ã  la perte.` },
            { name: "IsmaÃ¯l ï·º", subtitle: "La Ka'ba et Zamzam", emoji: "ğŸ”ï¸", story: `Fils d'Ibrahim et de Hajar. BÃ©bÃ©, laissÃ© dans une vallÃ©e aride, sa mÃ¨re chercha de l'eau. La source Zamzam jaillit sous ses pieds.\n\nIl aida son pÃ¨re Ã  construire la Ka'ba et fonda la lignÃ©e des Arabes du Hedjaz.\n\nğŸ“¿ LeÃ§on : La confiance absolue en Allah fait jaillir des sources dans le dÃ©sert.` },
            { name: "IshÃ¢q ï·º", subtitle: "Fils d'Ibrahim et Sarah", emoji: "â­", story: `Isaac est nÃ© alors que ses parents Ã©taient trÃ¨s Ã¢gÃ©s. De lui descend la lignÃ©e des prophÃ¨tes d'IsraÃ«l : Ya'qÃ»b, YÃ»suf, MÃ»sÃ¢, DÃ¢wÃ»d, SulaymÃ¢n, ÃsÃ¢.\n\nğŸ“¿ LeÃ§on : La promesse d'Allah se rÃ©alise toujours, mÃªme quand elle semble impossible.` },
            { name: "Ya'qÃ»b ï·º", subtitle: "PÃ¨re des 12 tribus", emoji: "ğŸŒ¾", story: `Ya'qÃ»b (Jacob) est aussi nommÃ© "IsraÃ«l". Il perdit son fils prÃ©fÃ©rÃ© YÃ»suf Ã  cause de la jalousie de ses autres fils.\n\nIl pleura de chagrin jusqu'Ã  perdre la vue, mais ne perdit jamais espoir en Allah. Sa vue lui fut rendue des dÃ©cennies plus tard.\n\nğŸ“¿ LeÃ§on : Le modÃ¨le du croyant qui ne dÃ©sespÃ¨re jamais dans l'Ã©preuve.` },
            { name: "YÃ»suf ï·º", subtitle: "La plus belle des histoires", emoji: "ğŸ’«", story: `Ses frÃ¨res jaloux le jetÃ¨rent dans un puits. Vendu comme esclave en Ã‰gypte, emprisonnÃ© injustement, il garda une foi inÃ©branlable.\n\nGrÃ¢ce Ã  son don d'interprÃ©ter les rÃªves, il devint ministre. Il pardonna Ã  ses frÃ¨res quand ils vinrent mendier du grain.\n\nğŸ“¿ LeÃ§on : Patience et confiance en Allah transforment les pires Ã©preuves en Ã©lÃ©vation.` },
            { name: "Shu'ayb ï·º", subtitle: "L'orateur des prophÃ¨tes", emoji: "âš–ï¸", story: `EnvoyÃ© Ã  Madyan, un peuple qui escroquait sur les poids et les mesures.\n\nIl les appela Ã  l'honnÃªtetÃ© commerciale. Face Ã  leur refus persistant, ils furent dÃ©truits.\n\nğŸ“¿ LeÃ§on : L'honnÃªtetÃ© dans le commerce est une obligation spirituelle majeure.` },
            { name: "MÃ»sÃ¢ ï·º", subtitle: "Ã€ qui Allah a parlÃ© directement", emoji: "âš¡", story: `SauvÃ© des eaux bÃ©bÃ©, Ã©levÃ© chez Pharaon. Plus tard, Allah lui parla sur le mont SinaÃ¯ et l'envoya libÃ©rer les HÃ©breux.\n\nIl affronta Pharaon, fendit la mer Rouge. Pharaon se noya.\n\nğŸ“¿ LeÃ§on : Face aux tyrans de toute Ã©poque, Allah soutient toujours Ses Ã©lus.` },
            { name: "HÃ¢rÃ»n ï·º", subtitle: "Le frÃ¨re de MÃ»sÃ¢", emoji: "ğŸ—£ï¸", story: `HÃ¢rÃ»n est le frÃ¨re aÃ®nÃ© de MÃ»sÃ¢, demandÃ© par MÃ»sÃ¢ lui-mÃªme pour l'aider dans sa mission car il Ã©tait plus Ã©loquent.\n\nIl affronta Pharaon Ã  ses cÃ´tÃ©s.\n\nğŸ“¿ LeÃ§on : Chercher de l'aide et s'entourer de gens de bien est une sagesse, pas une faiblesse.` },
            { name: "Dhul-Kifl ï·º", subtitle: "Le prophÃ¨te garant", emoji: "ğŸ›¡ï¸", story: `Un prophÃ¨te qui prit l'engagement de prier la nuit, jeÃ»ner le jour et ne jamais se mettre en colÃ¨re.\n\nIblis tenta de l'Ã©prouver et de le mettre en colÃ¨re, mais il resta parfaitement patient.\n\nğŸ“¿ LeÃ§on : Tenir ses promesses et maÃ®triser sa colÃ¨re sont des vertus prophÃ©tiques.` },
            { name: "AyyÃ»b ï·º", subtitle: "L'incarnation de la patience", emoji: "ğŸŒ±", story: `Riche et en bonne santÃ©, AyyÃ»b perdit tout : ses biens, ses enfants et sa santÃ©. Seule sa femme resta avec lui.\n\nIl endura pendant des annÃ©es sans se plaindre avant d'implorer la misÃ©ricorde d'Allah. Allah lui rendit le double de ce qu'il avait perdu.\n\nğŸ“¿ LeÃ§on : Allah ne teste que ceux qu'Il aime.` },
            { name: "YÃ»nus ï·º", subtitle: "L'homme de la baleine", emoji: "ğŸ‹", story: `DÃ©couragÃ© par son peuple, il partit en bateau. JetÃ© Ã  la mer, une baleine l'avala.\n\nDans les tÃ©nÃ¨bres, il fit la fameuse invocation de la repentance. Allah le sauva et le ramena vers son peuple qui avait finalement cru.\n\nğŸ“¿ LeÃ§on : MÃªme dans nos pires moments, la dua sincÃ¨re nous sauve.` },
            { name: "IlyÃ¢s ï·º", subtitle: "DÃ©fenseur du Tawhid", emoji: "ğŸŒŠ", story: `Il fut envoyÃ© aux enfants d'IsraÃ«l pour combattre le culte de l'idole Ba'l.\n\nFace Ã  leur obstination, il maintint le message de l'UnicitÃ© coÃ»te que coÃ»te.\n\nğŸ“¿ LeÃ§on : Combattre les fausses idoles de notre temps (argent, ego) est essentiel.` },
            { name: "Al-Yasa' ï·º", subtitle: "Le successeur d'IlyÃ¢s", emoji: "ğŸŒ¿", story: `Disciple puis successeur d'IlyÃ¢s dans la prophÃ©tie. Il continua discrÃ¨tement mais fidÃ¨lement la mission de son maÃ®tre.\n\nğŸ“¿ LeÃ§on : La continuitÃ© discrÃ¨te et la loyautÃ© sont extrÃªmement prÃ©cieuses.` },
            { name: "DÃ¢wÃ»d ï·º", subtitle: "Roi et prophÃ¨te", emoji: "ğŸµ", story: `Jeune berger, il tua le gÃ©ant Goliath. Devenu roi, il jeÃ»nait un jour sur deux et priait la nuit.\n\nIl reÃ§ut les Psaumes. Sa voix Ã©tait si belle que la nature participait Ã  ses louanges.\n\nğŸ“¿ LeÃ§on : On peut allier pouvoir terrestre et profonde humilitÃ© spirituelle.` },
            { name: "SulaymÃ¢n ï·º", subtitle: "MaÃ®tre des djinns et des animaux", emoji: "ğŸ‘‘", story: `Fils de DÃ¢wÃ»d, il comprenait le langage des animaux et commandait aux djinns. Il bÃ¢tit un royaume sans pareil.\n\nIl mourut appuyÃ© sur sa canne sans que les djinns ne s'en aperÃ§oivent, prouvant qu'ils ne connaissent pas l'invisible.\n\nğŸ“¿ LeÃ§on : Toute gloire terrestre n'est qu'un test de gratitude envers Allah.` },
            { name: "ZakariyyÃ¢ ï·º", subtitle: "La priÃ¨re exaucÃ©e dans la vieillesse", emoji: "ğŸŒ¸", story: `TrÃ¨s Ã¢gÃ© et mariÃ© Ã  une femme stÃ©rile, il pria Allah en secret pour avoir un hÃ©ritier pieux aprÃ¨s avoir vu les miracles de Maryam.\n\nAllah l'exauÃ§a et lui donna YahyÃ¢.\n\nğŸ“¿ LeÃ§on : La misÃ©ricorde d'Allah n'a pas de limites biologiques ou physiques.` },
            { name: "YahyÃ¢ ï·º", subtitle: "La sagesse dÃ¨s l'enfance", emoji: "ğŸ•Šï¸", story: `Fils de ZakariyyÃ¢, Jean-Baptiste reÃ§ut la sagesse dÃ¨s son jeune Ã¢ge. Il Ã©tait doux, pur et dÃ©vouÃ©.\n\nIl mourut martyr pour avoir dit la vÃ©ritÃ© face Ã  un tyran.\n\nğŸ“¿ LeÃ§on : Dire la vÃ©ritÃ© au pouvoir est une grande preuve de foi.` },
            { name: "ÃsÃ¢ ï·º", subtitle: "Le Messie, fils de Maryam", emoji: "âœ¨", story: `NÃ© miraculeusement sans pÃ¨re. Il parlait au berceau, guÃ©rissait les lÃ©preux et ressuscitait les morts par la permission d'Allah.\n\nAllah l'a Ã©levÃ© au ciel pour le sauver. Il reviendra Ã  la fin des temps.\n\nğŸ“¿ LeÃ§on : Issa est un grand Messager de paix et de puretÃ©.` },
            { name: "Muhammad ï·º", subtitle: "Le sceau des prophÃ¨tes", emoji: "ğŸŒ™", story: `Le dernier des prophÃ¨tes. Devenu orphelin trÃ¨s jeune, connu pour son honnÃªtetÃ©. Ã€ 40 ans, il reÃ§ut la rÃ©vÃ©lation du Coran.\n\nEn 23 ans, il transforma une sociÃ©tÃ© tribale divisÃ©e en la plus grande civilisation de l'histoire, unie par la foi.\n\nğŸ“¿ LeÃ§on : Le meilleur des exemples pour toute l'humanitÃ© jusqu'Ã  la fin des temps.` }
        ];

        // ============ 99 NOMS D'ALLAH ============
        const ALLAH_NAMES = [
            {n:"AllÃ¢h",a:"Ø§Ù„Ù„Ù‡",t:"Le nom suprÃªme"}, {n:"Ar-RahmÃ¢n",a:"Ø§Ù„Ø±Ø­Ù…Ù†",t:"Le Tout-MisÃ©ricordieux"}, {n:"Ar-RahÃ®m",a:"Ø§Ù„Ø±Ø­ÙŠÙ…",t:"Le TrÃ¨s-MisÃ©ricordieux"}, {n:"Al-Malik",a:"Ø§Ù„Ù…Ù„Ùƒ",t:"Le Roi"}, {n:"Al-QuddÃ»s",a:"Ø§Ù„Ù‚Ø¯ÙˆØ³",t:"Le Saint"},
            {n:"As-SalÃ¢m",a:"Ø§Ù„Ø³Ù„Ø§Ù…",t:"La Paix"}, {n:"Al-Mu'min",a:"Ø§Ù„Ù…Ø¤Ù…Ù†",t:"Le Garant de la sÃ©curitÃ©"}, {n:"Al-Muhaymin",a:"Ø§Ù„Ù…Ù‡ÙŠÙ…Ù†",t:"Le Protecteur"}, {n:"Al-'AzÃ®z",a:"Ø§Ù„Ø¹Ø²ÙŠØ²",t:"Le Tout-Puissant"}, {n:"Al-JabbÃ¢r",a:"Ø§Ù„Ø¬Ø¨Ø§Ø±",t:"Le Contraignant, le RÃ©parateur"},
            {n:"Al-Mutakabbir",a:"Ø§Ù„Ù…ØªÙƒØ¨Ø±",t:"Le Superbe"}, {n:"Al-KhÃ¢liq",a:"Ø§Ù„Ø®Ø§Ù„Ù‚",t:"Le CrÃ©ateur"}, {n:"Al-BÃ¢ri'",a:"Ø§Ù„Ø¨Ø§Ø±Ø¦",t:"Le CrÃ©ateur de rien"}, {n:"Al-Musawwir",a:"Ø§Ù„Ù…ØµÙˆØ±",t:"Le Formateur"}, {n:"Al-GhaffÃ¢r",a:"Ø§Ù„ØºÙØ§Ø±",t:"Le Tout-Pardonneur"},
            {n:"Al-QahhÃ¢r",a:"Ø§Ù„Ù‚Ù‡Ø§Ø±",t:"Le Dominateur suprÃªme"}, {n:"Al-WahhÃ¢b",a:"Ø§Ù„ÙˆÙ‡Ø§Ø¨",t:"Le Donateur universel"}, {n:"Ar-RazzÃ¢q",a:"Ø§Ù„Ø±Ø²Ø§Ù‚",t:"Le Pourvoyeur"}, {n:"Al-FattÃ¢h",a:"Ø§Ù„ÙØªØ§Ø­",t:"Celui qui ouvre, le Juge"}, {n:"Al-'AlÃ®m",a:"Ø§Ù„Ø¹Ù„ÙŠÙ…",t:"L'Omniscient"},
            {n:"Al-QÃ¢bid",a:"Ø§Ù„Ù‚Ø§Ø¨Ø¶",t:"Celui qui retient"}, {n:"Al-BÃ¢sit",a:"Ø§Ù„Ø¨Ø§Ø³Ø·",t:"Celui qui dilate"}, {n:"Al-KhÃ¢fid",a:"Ø§Ù„Ø®Ø§ÙØ¶",t:"Celui qui abaisse"}, {n:"Ar-RÃ¢fi'",a:"Ø§Ù„Ø±Ø§ÙØ¹",t:"Celui qui Ã©lÃ¨ve"}, {n:"Al-Mu'izz",a:"Ø§Ù„Ù…Ø¹Ø²",t:"Celui qui donne la puissance"},
            {n:"Al-Mudhill",a:"Ø§Ù„Ù…Ø°Ù„",t:"Celui qui avilit"}, {n:"As-SamÃ®'",a:"Ø§Ù„Ø³Ù…ÙŠØ¹",t:"L'Audient"}, {n:"Al-BasÃ®r",a:"Ø§Ù„Ø¨ØµÙŠØ±",t:"Le Clairvoyant"}, {n:"Al-Hakam",a:"Ø§Ù„Ø­ÙƒÙ…",t:"Le Juge"}, {n:"Al-'Adl",a:"Ø§Ù„Ø¹Ø¯Ù„",t:"Le Juste"},
            {n:"Al-LatÃ®f",a:"Ø§Ù„Ù„Ø·ÙŠÙ",t:"Le Subtil"}, {n:"Al-KhabÃ®r",a:"Ø§Ù„Ø®Ø¨ÙŠØ±",t:"Le TrÃ¨s-InformÃ©"}, {n:"Al-HalÃ®m",a:"Ø§Ù„Ø­Ù„ÙŠÙ…",t:"Le Longanime"}, {n:"Al-'AzÃ®m",a:"Ø§Ù„Ø¹Ø¸ÙŠÙ…",t:"L'Immense"}, {n:"Al-GhafÃ»r",a:"Ø§Ù„ØºÙÙˆØ±",t:"Le TrÃ¨s-Pardonneur"},
            {n:"Ash-ShakÃ»r",a:"Ø§Ù„Ø´ÙƒÙˆØ±",t:"Le TrÃ¨s-Reconnaissant"}, {n:"Al-'Aliyy",a:"Ø§Ù„Ø¹Ù„ÙŠ",t:"Le Sublime"}, {n:"Al-KabÃ®r",a:"Ø§Ù„ÙƒØ¨ÙŠØ±",t:"L'Infiniment Grand"}, {n:"Al-HafÃ®z",a:"Ø§Ù„Ø­ÙÙŠØ¸",t:"Le PrÃ©servateur"}, {n:"Al-MuqÃ®t",a:"Ø§Ù„Ù…Ù‚ÙŠØª",t:"Le Nourricier"},
            {n:"Al-HasÃ®b",a:"Ø§Ù„Ø­Ø³ÙŠØ¨",t:"Celui qui tient compte de tout"}, {n:"Al-JalÃ®l",a:"Ø§Ù„Ø¬Ù„ÙŠÙ„",t:"Le Majestueux"}, {n:"Al-KarÃ®m",a:"Ø§Ù„ÙƒØ±ÙŠÙ…",t:"Le Tout-GÃ©nÃ©reux"}, {n:"Ar-RaqÃ®b",a:"Ø§Ù„Ø±Ù‚ÙŠØ¨",t:"L'Observateur"}, {n:"Al-MujÃ®b",a:"Ø§Ù„Ù…Ø¬ÙŠØ¨",t:"Celui qui exauce"},
            {n:"Al-WÃ¢si'",a:"Ø§Ù„ÙˆØ§Ø³Ø¹",t:"Le Vaste, l'OmniprÃ©sent"}, {n:"Al-HakÃ®m",a:"Ø§Ù„Ø­ÙƒÙŠÙ…",t:"L'Infiniment Sage"}, {n:"Al-WadÃ»d",a:"Ø§Ù„ÙˆØ¯ÙˆØ¯",t:"Le Bien-Aimant"}, {n:"Al-MajÃ®d",a:"Ø§Ù„Ù…Ø¬ÙŠØ¯",t:"Le TrÃ¨s Glorieux"}, {n:"Al-BÃ¢'ith",a:"Ø§Ù„Ø¨Ø§Ø¹Ø«",t:"Celui qui ressuscite"},
            {n:"Ash-ShahÃ®d",a:"Ø§Ù„Ø´Ù‡ÙŠØ¯",t:"Le TÃ©moin"}, {n:"Al-Haqq",a:"Ø§Ù„Ø­Ù‚",t:"La VÃ©ritÃ©"}, {n:"Al-WakÃ®l",a:"Ø§Ù„ÙˆÙƒÙŠÙ„",t:"Le GÃ©rant, le Garant"}, {n:"Al-Qawiyy",a:"Ø§Ù„Ù‚ÙˆÙŠ",t:"Le TrÃ¨s-Fort"}, {n:"Al-MatÃ®n",a:"Ø§Ù„Ù…ØªÙŠÙ†",t:"Le TrÃ¨s-Ferme"},
            {n:"Al-Waliyy",a:"Ø§Ù„ÙˆÙ„ÙŠ",t:"Le Protecteur"}, {n:"Al-HamÃ®d",a:"Ø§Ù„Ø­Ù…ÙŠØ¯",t:"Le Digne de louange"}, {n:"Al-MuhsÃ®",a:"Ø§Ù„Ù…Ø­ØµÙŠ",t:"Celui qui tient les comptes"}, {n:"Al-Mubdi'",a:"Ø§Ù„Ù…Ø¨Ø¯Ø¦",t:"L'Auteur de la crÃ©ation"}, {n:"Al-Mu'Ã®d",a:"Ø§Ù„Ù…Ø¹ÙŠØ¯",t:"Celui qui fait revenir"},
            {n:"Al-MuhyÃ®",a:"Ø§Ù„Ù…Ø­ÙŠÙŠ",t:"Celui qui donne la vie"}, {n:"Al-MumÃ®t",a:"Ø§Ù„Ù…Ù…ÙŠØª",t:"Celui qui donne la mort"}, {n:"Al-Hayy",a:"Ø§Ù„Ø­ÙŠ",t:"Le Vivant"}, {n:"Al-QayyÃ»m",a:"Ø§Ù„Ù‚ÙŠÙˆÙ…",t:"L'Immuable"}, {n:"Al-WÃ¢jid",a:"Ø§Ù„ÙˆØ§Ø¬Ø¯",t:"L'Opulent"},
            {n:"Al-MÃ¢jid",a:"Ø§Ù„Ù…Ø§Ø¬Ø¯",t:"Le Noble"}, {n:"Al-WÃ¢hid",a:"Ø§Ù„ÙˆØ§Ø­Ø¯",t:"L'Unique"}, {n:"As-Samad",a:"Ø§Ù„ØµÙ…Ø¯",t:"Le MaÃ®tre absolu"}, {n:"Al-QÃ¢dir",a:"Ø§Ù„Ù‚Ø§Ø¯Ø±",t:"Le Puissant"}, {n:"Al-Muqtadir",a:"Ø§Ù„Ù…Ù‚ØªØ¯Ø±",t:"L'Omnipotent"},
            {n:"Al-Muqaddim",a:"Ø§Ù„Ù…Ù‚Ø¯Ù…",t:"Celui qui avance"}, {n:"Al-Mu'akhkhir",a:"Ø§Ù„Ù…Ø¤Ø®Ø±",t:"Celui qui retarde"}, {n:"Al-Awwal",a:"Ø§Ù„Ø£ÙˆÙ„",t:"Le Premier"}, {n:"Al-Ã‚khir",a:"Ø§Ù„Ø¢Ø®Ø±",t:"Le Dernier"}, {n:"Az-ZÃ¢hir",a:"Ø§Ù„Ø¸Ø§Ù‡Ø±",t:"L'Apparent"},
            {n:"Al-BÃ¢tin",a:"Ø§Ù„Ø¨Ø§Ø·Ù†",t:"Le CachÃ©"}, {n:"Al-WÃ¢lÃ®",a:"Ø§Ù„ÙˆØ§Ù„ÙŠ",t:"Le Monarque suprÃªme"}, {n:"Al-Muta'Ã¢lÃ®",a:"Ø§Ù„Ù…ØªØ¹Ø§Ù„ÙŠ",t:"Le Sublime"}, {n:"Al-Barr",a:"Ø§Ù„Ø¨Ø±",t:"Le Bienfaiteur"}, {n:"At-TawwÃ¢b",a:"Ø§Ù„ØªÙˆØ§Ø¨",t:"Celui qui accueille le repentir"},
            {n:"Al-Muntaqim",a:"Ø§Ù„Ù…Ù†ØªÙ‚Ù…",t:"Le Vengeur"}, {n:"Al-'Afuww",a:"Ø§Ù„Ø¹ÙÙˆ",t:"L'Indulgent"}, {n:"Ar-Ra'Ã»f",a:"Ø§Ù„Ø±Ø¤ÙˆÙ",t:"Le Bienveillant"}, {n:"MÃ¢lik-ul-Mulk",a:"Ù…Ø§Ù„Ùƒ Ø§Ù„Ù…Ù„Ùƒ",t:"Le Possesseur du Royaume"}, {n:"Dhul-JalÃ¢l-wal-IkrÃ¢m",a:"Ø°Ùˆ Ø§Ù„Ø¬Ù„Ø§Ù„ ÙˆØ§Ù„Ø¥ÙƒØ±Ø§Ù…",t:"Le Majestueux et GÃ©nÃ©reux"},
            {n:"Al-Muqsit",a:"Ø§Ù„Ù…Ù‚Ø³Ø·",t:"L'Ã‰quitable"}, {n:"Al-JÃ¢mi'",a:"Ø§Ù„Ø¬Ø§Ù…Ø¹",t:"Le Rassembleur"}, {n:"Al-Ghaniyy",a:"Ø§Ù„ØºÙ†ÙŠ",t:"Le Riche, l'IndÃ©pendant"}, {n:"Al-MughnÃ®",a:"Ø§Ù„Ù…ØºÙ†ÙŠ",t:"Celui qui enrichit"}, {n:"Al-MÃ¢ni'",a:"Ø§Ù„Ù…Ø§Ù†Ø¹",t:"Le DÃ©fenseur, Celui qui empÃªche"},
            {n:"Ad-DÃ¢rr",a:"Ø§Ù„Ø¶Ø§Ø±",t:"Celui qui contrarie"}, {n:"An-NÃ¢fi'",a:"Ø§Ù„Ù†Ø§ÙØ¹",t:"Celui qui accorde le profit"}, {n:"An-NÃ»r",a:"Ø§Ù„Ù†ÙˆØ±",t:"La LumiÃ¨re"}, {n:"Al-HÃ¢dÃ®",a:"Ø§Ù„Ù‡Ø§Ø¯ÙŠ",t:"Le Guide"}, {n:"Al-BadÃ®'",a:"Ø§Ù„Ø¨Ø¯ÙŠØ¹",t:"L'Inventeur crÃ©ateur"},
            {n:"Al-BÃ¢qÃ®",a:"Ø§Ù„Ø¨Ø§Ù‚ÙŠ",t:"Le Permanent, l'Ã‰ternel"}, {n:"Al-WÃ¢rith",a:"Ø§Ù„ÙˆØ§Ø±Ø«",t:"L'HÃ©ritier suprÃªme"}, {n:"Ar-RashÃ®d",a:"Ø§Ù„Ø±Ø´ÙŠØ¯",t:"Celui qui agit avec droiture"}, {n:"As-SabÃ»r",a:"Ø§Ù„ØµØ¨ÙˆØ±",t:"Le Patient"}
        ];

        // ============ ARABIC LETTERS ============
        const ARABIC_LETTERS = [
            {l:"Ø§",n:"Alif"},{l:"Ø¨",n:"BÃ¢"},{l:"Øª",n:"TÃ¢"},{l:"Ø«",n:"ThÃ¢"},{l:"Ø¬",n:"JÃ®m"},{l:"Ø­",n:"HÃ¢"},{l:"Ø®",n:"KhÃ¢"},{l:"Ø¯",n:"DÃ¢l"},{l:"Ø°",n:"DhÃ¢l"},{l:"Ø±",n:"RÃ¢"},{l:"Ø²",n:"ZÃ¢y"},{l:"Ø³",n:"SÃ®n"},{l:"Ø´",n:"ShÃ®n"},{l:"Øµ",n:"SÃ¢d"},{l:"Ø¶",n:"DÃ¢d"},{l:"Ø·",n:"TÃ¢"},{l:"Ø¸",n:"DhÃ¢"},{l:"Ø¹",n:"'Ayn"},{l:"Øº",n:"Ghayn"},{l:"Ù",n:"FÃ¢"},{l:"Ù‚",n:"QÃ¢f"},{l:"Ùƒ",n:"KÃ¢f"},{l:"Ù„",n:"LÃ¢m"},{l:"Ù…",n:"MÃ®m"},{l:"Ù†",n:"NÃ»n"},{l:"Ù‡",n:"HÃ¢"},{l:"Ùˆ",n:"WÃ¢w"},{l:"ÙŠ",n:"YÃ¢"}
        ];

        // ============ STATE & UTILS ============
        let sessionState = null;
        let timerInterval = null;
        let elapsedTime = 0;

        function showToast(msg) {
            const t = document.createElement('div');
            t.className = 'toast-anim fixed top-6 left-1/2 -translate-x-1/2 bg-white text-rose-600 px-6 py-3 rounded-2xl text-xs font-bold z-[999] shadow-xl border border-rose-200';
            t.innerText = msg;
            document.body.appendChild(t);
            setTimeout(() => t.remove(), 2500);
        }
        window.showToast = showToast;

        const TABS = ['home','train','arabic','prophets','allah','foundations','duas'];
        window.showTab = (tab) => {
            TABS.forEach(t => {
                document.getElementById('tab-'+t)?.classList.add('hidden');
                document.getElementById('nav-'+t)?.classList.remove('active-nav');
            });
            document.getElementById('tab-'+tab)?.classList.remove('hidden');
            document.getElementById('nav-'+tab)?.classList.add('active-nav');
            window.scrollTo(0,0);
            
            if (tab === 'home') renderHome();
            if (tab === 'arabic') renderArabicTab();
            if (tab === 'prophets') renderProphets();
            if (tab === 'allah') renderAllahNames();
            if (tab === 'foundations') showFoundSection('pillars');
            if (tab === 'duas') renderDuas();
            if (tab === 'train') { document.getElementById('surah-selector').classList.remove('hidden'); document.getElementById('session-view').classList.add('hidden'); document.getElementById('result-view').classList.add('hidden'); }
            lucide.createIcons();
        };

        // ============ HOME ============
        function renderHome() {
            const today = new Date().toISOString().split('T')[0];
            const todaySess = sessions.filter(s => new Date(s.ts).toISOString().split('T')[0] === today);
            document.getElementById('streak-val').innerText = userData.streak||0;
            document.getElementById('today-val').innerText = todaySess.length;
            document.getElementById('total-val').innerText = sessions.length;

            const levelLabels = ['','â­','â­â­','â­â­â­'];
            const barColors = ['','bg-rose-300','bg-amber-300','bg-purple-300'];
            document.getElementById('home-surahs').innerHTML = SURAHS.map(s => {
                const sc = (scores[s.id])||{attempts:0,easy:0};
                const pct = sc.attempts>0 ? Math.round((sc.easy/sc.attempts)*100) : 0;
                return `<button onclick="window.startSession('${s.id}')" class="card p-4 text-left active:scale-95 transition-all w-full">
                    <div class="flex items-center gap-3 mb-2">
                        <span class="text-xl">${s.emoji}</span>
                        <div class="flex-1 min-w-0">
                            <div class="flex justify-between"><p class="font-bold text-sm truncate" style="color:#3D2B2B">${s.name}</p><span class="text-xs text-stone-400 ml-1">${s.verses.length}v</span></div>
                            <p class="text-xs text-stone-400">${levelLabels[s.level]}</p>
                        </div>
                    </div>
                    <div class="w-full bg-rose-50 rounded-full h-1.5"><div class="${barColors[s.level]} h-1.5 rounded-full" style="width:${pct}%"></div></div>
                    <p class="text-[10px] text-stone-400 mt-1">${sc.attempts>0?`${pct}% fluide Â· ${sc.attempts} lectures` : 'Pas encore pratiquÃ©'}</p>
                </button>`;
            }).join('');
        }
        window.renderHome = renderHome;

        // ============ TRAINING ============
        window.startSession = (surahId) => {
            const surah = SURAHS.find(s=>s.id===surahId);
            if (!surah) return;
            sessionState = {surahId, verseIndex:0, startTime:Date.now(), ratings:[]};
            elapsedTime = 0;
            document.getElementById('sess-surah-name').innerText = surah.name;
            document.getElementById('sess-surah-ar').innerText = surah.nameAr;
            document.getElementById('sess-tip').innerText = 'ğŸ’¡ '+surah.tip;
            renderVerseInSession();
            if (timerInterval) clearInterval(timerInterval);
            timerInterval = setInterval(()=>{ elapsedTime++; document.getElementById('sess-timer').innerText=`${Math.floor(elapsedTime/60).toString().padStart(2,'0')}:${(elapsedTime%60).toString().padStart(2,'0')}`; },1000);
            document.getElementById('surah-selector').classList.add('hidden');
            document.getElementById('session-view').classList.remove('hidden');
            window.scrollTo(0,0);
        };

        function renderVerseInSession() {
            if (!sessionState) return;
            const surah = SURAHS.find(s=>s.id===sessionState.surahId);
            const verse = surah.verses[sessionState.verseIndex];
            document.getElementById('sess-verse-num').innerText = `Verset ${verse.n}`;
            document.getElementById('sess-verse-ar').innerText = verse.ar;
            document.getElementById('sess-verse-tr').innerText = verse.tr;
            document.getElementById('sess-progress-txt').innerText = `${sessionState.verseIndex+1} / ${surah.verses.length}`;
            document.getElementById('sess-progress-bar').style.width = `${((sessionState.verseIndex+1)/surah.verses.length)*100}%`;
            document.querySelectorAll('.rating-btn').forEach(b=>b.classList.remove('sel'));
        }

        window.rateVerse = (rating) => {
            if (!sessionState) return;
            sessionState.ratings.push(rating);
            const surah = SURAHS.find(s=>s.id===sessionState.surahId);
            if (sessionState.verseIndex < surah.verses.length-1) {
                sessionState.verseIndex++;
                renderVerseInSession();
            } else { finishSession(); }
        };

        function finishSession() {
            clearInterval(timerInterval);
            const surah = SURAHS.find(s=>s.id===sessionState.surahId);
            const ratings = sessionState.ratings;
            if (!scores[sessionState.surahId]) scores[sessionState.surahId]={easy:0,medium:0,hard:0,attempts:0};
            const sc = scores[sessionState.surahId];
            sc.attempts++;
            ratings.forEach(r=>{ if(r==='easy')sc.easy++; else if(r==='medium')sc.medium++; else sc.hard++; });
            sessions.push({ts:Date.now(),surahId:sessionState.surahId,verseCount:surah.verses.length,duration:elapsedTime,ratings});
            userData.lastSession = new Date().toISOString().split('T')[0];
            saveMain();
            document.getElementById('session-view').classList.add('hidden');
            document.getElementById('result-view').classList.remove('hidden');
            sessionState=null;
            renderHome();
        }

        window.backToSelector = () => {
            if(timerInterval){clearInterval(timerInterval);sessionState=null;}
            document.getElementById('session-view').classList.add('hidden');
            document.getElementById('result-view').classList.add('hidden');
            document.getElementById('surah-selector').classList.remove('hidden');
        };

        // ============ ARABIC TAB ============
        function renderArabicTab() {
            const grid = document.getElementById('arabic-grid');
            const learned = JSON.parse(localStorage.getItem('samia-letters') || '{}');
            const count = Object.values(learned).filter(v => v).length;
            document.getElementById('letter-count').innerText = `${count}/28`;

            grid.innerHTML = ARABIC_LETTERS.map((l,i) => `
                <div class="card p-3 relative flex flex-col items-center">
                    <button onclick="window.toggleLetter(${i}, this)" class="absolute top-2 right-2 w-5 h-5 rounded border ${learned[i] ? 'bg-rose-400 border-rose-400 text-white' : 'border-stone-300 text-transparent'} flex items-center justify-center transition-all">
                        <i data-lucide="check" class="w-3 h-3"></i>
                    </button>
                    <p class="amiri text-4xl text-rose-500 my-2">${l.l}</p>
                    <p class="text-xs font-bold text-stone-700">${l.n}</p>
                </div>
            `).join('');
            lucide.createIcons();
        }

        window.toggleLetter = (idx, btnEl) => {
            const learned = JSON.parse(localStorage.getItem('samia-letters') || '{}');
            learned[idx] = !learned[idx];
            localStorage.setItem('samia-letters', JSON.stringify(learned));
            renderArabicTab();
        };

        // ============ PROPHETS TAB ============
        function renderProphets() {
            const list = document.getElementById('prophets-grid');
            if (list.children.length === 0) {
                list.innerHTML = PROPHETS.map((p,i) => `
                    <button onclick="window.showProphet(${i})" class="card p-4 text-left active:scale-95 transition-all">
                        <span class="text-2xl block mb-2">${p.emoji}</span>
                        <p class="font-bold text-sm text-stone-800">${p.name}</p>
                        <p class="text-[10px] text-stone-500 mt-0.5">${p.subtitle}</p>
                    </button>
                `).join('');
            }
        }

        window.showProphet = (i) => {
            const p = PROPHETS[i];
            document.getElementById('prophet-emoji').innerText = p.emoji;
            document.getElementById('prophet-name-big').innerText = p.name;
            document.getElementById('prophet-sub').innerText = p.subtitle;
            document.getElementById('prophet-story').innerText = p.story;
            document.getElementById('prophets-list-view').classList.add('hidden');
            document.getElementById('prophet-detail').classList.remove('hidden');
        };
        window.backToProphets = () => {
            document.getElementById('prophet-detail').classList.add('hidden');
            document.getElementById('prophets-list-view').classList.remove('hidden');
        };

        // ============ ALLAH NAMES TAB ============
        function renderAllahNames() {
            const container = document.getElementById('allah-names-list');
            const learned = JSON.parse(localStorage.getItem('samia-names') || '{}');
            const count = Object.values(learned).filter(v => v).length;
            document.getElementById('allah-count').innerText = `${count}/99`;

            container.innerHTML = ALLAH_NAMES.map((n,i) => `
                <div class="card p-3 mb-2 flex items-center gap-3 active:scale-[0.98] transition-all cursor-pointer" onclick="window.toggleAllahName(${i})">
                    <div class="w-6 h-6 rounded-full border flex items-center justify-center flex-shrink-0 ${learned[i] ? 'bg-emerald-400 border-emerald-400 text-white' : 'border-stone-300 text-transparent'} transition-all">
                        <i data-lucide="check" class="w-3 h-3"></i>
                    </div>
                    <span class="text-stone-400 text-[10px] font-black w-5">${i+1}</span>
                    <span class="amiri text-2xl text-emerald-500 w-16 text-center">${n.a}</span>
                    <div class="flex-1 min-w-0">
                        <p class="font-bold text-sm text-stone-800 truncate">${n.n}</p>
                        <p class="text-[10px] text-stone-500 truncate">${n.t}</p>
                    </div>
                </div>
            `).join('');
            lucide.createIcons();
        }

        window.toggleAllahName = (idx) => {
            const learned = JSON.parse(localStorage.getItem('samia-names') || '{}');
            learned[idx] = !learned[idx];
            localStorage.setItem('samia-names', JSON.stringify(learned));
            renderAllahNames();
        };

        // ============ FOUNDATIONS TAB (UPDATED) ============
        window.showFoundSection = (section) => {
            ['pratique','foi','histoire','coeur','ramadan'].forEach(s => {
                document.getElementById('fsection-' + s)?.classList.toggle('hidden', s !== section);
                const btn = document.getElementById('fsec-' + s);
                if (btn) {
                    btn.classList.toggle('bg-rose-400', s === section);
                    btn.classList.toggle('text-white', s === section);
                    btn.classList.toggle('bg-white', s !== section);
                    btn.classList.toggle('text-stone-500', s !== section);
                    btn.classList.toggle('border', s !== section);
                }
            });
            lucide.createIcons();
        };

        // ============ DUAS TAB ============
        window.renderDuas = () => {
            document.getElementById('personal-duas-list').innerHTML = personalDuas.length > 0
                ? personalDuas.slice().reverse().map((d,ri) => {
                    const i = personalDuas.length-1-ri;
                    return `<div class="card p-4 mb-3">
                        <div class="flex justify-between mb-1">
                            <p class="font-bold text-sm text-indigo-500">${d.title||'Ma dua'}</p>
                            <button onclick="window.deleteDua(${i})" class="text-stone-300 text-xs">âœ•</button>
                        </div>
                        <p class="text-sm text-stone-600 leading-relaxed">${d.text}</p>
                    </div>`;
                }).join('')
                : '<p class="text-stone-400 italic text-sm text-center py-6">Tes duas personnelles s\'afficheront ici ğŸ¤²</p>';
        };

        window.addDua = async () => {
            const title = document.getElementById('dua-title-inp').value.trim();
            const text = document.getElementById('dua-text-inp').value.trim();
            if (!text) return;
            personalDuas.push({title, text, ts:Date.now()});
            document.getElementById('dua-title-inp').value='';
            document.getElementById('dua-text-inp').value='';
            saveMain();
            window.renderDuas();
            showToast('Dua sauvegardÃ©e ğŸ¤²');
        };
        window.deleteDua = async (i) => { personalDuas.splice(i,1); saveMain(); window.renderDuas(); };

        // ============ INIT ============
        function initApp() {
            loadAll();
            document.getElementById('loading').style.display = 'none';
            document.getElementById('app').classList.remove('hidden');
            renderHome();
            lucide.createIcons();
            
            const grid = document.querySelector('#surah-selector .grid');
            if (grid && SURAHS) {
                grid.innerHTML = SURAHS.map(s => `<button onclick="window.startSession('${s.id}')" class="card p-4 text-left active:scale-95 transition-all w-full"><span class="text-xl block mb-2">${s.emoji}</span><p class="font-bold text-sm" style="color:#3D2B2B">${s.name}</p><p class="text-xs text-stone-400">${s.verses.length}v Â· ${'â­'.repeat(s.level)}</p></button>`).join('');
            }
        }
        document.addEventListener("DOMContentLoaded", initApp);
    </script>
</head>
<body class="pb-nav">

<div id="loading" class="fixed inset-0 z-[500] flex flex-col items-center justify-center gap-5 bg-[#FDF8F3]">
    <div class="w-16 h-16 rounded-full flex items-center justify-center text-3xl" style="background:linear-gradient(135deg,#E8A4A4,#C47A7A);box-shadow:0 8px 24px rgba(196,122,122,0.3)">ğŸŒ¸</div>
    <p class="playfair text-2xl font-bold text-center" style="color:#3D2B2B">Salam Samia ğŸŒ™</p>
</div>

<div id="app" class="hidden">

<div id="tab-home" class="px-4 pb-nav">
    <header class="pt-12 pb-5 flex justify-between items-start">
        <div>
            <p class="text-xs uppercase font-bold tracking-widest text-stone-400">Salam 'Alaykum</p>
            <h1 class="playfair text-3xl font-bold mt-1" style="color:#3D2B2B">Samia ğŸŒ¸</h1>
            <p class="text-xs font-medium mt-0.5 text-rose-400">EntraÃ®ne ta lecture arabe</p>
        </div>
        <div class="w-14 h-14 rounded-2xl flex items-center justify-center text-2xl shadow-lg" style="background:linear-gradient(135deg,#E8A4A4,#C47A7A);">ğŸ“–</div>
    </header>

    <div class="grid grid-cols-3 gap-3 mb-5">
        <div class="card p-4 text-center"><p class="text-xl font-black text-rose-500" id="streak-val">0</p><p class="text-[9px] text-stone-400 uppercase tracking-widest mt-1">SÃ©rie ğŸ”¥</p></div>
        <div class="card p-4 text-center"><p class="text-xl font-black text-purple-400" id="today-val">0</p><p class="text-[9px] text-stone-400 uppercase tracking-widest mt-1">Auj.</p></div>
        <div class="card p-4 text-center"><p class="text-xl font-black text-amber-500" id="total-val">0</p><p class="text-[9px] text-stone-400 uppercase tracking-widest mt-1">Total</p></div>
    </div>

    <h2 class="text-xs font-black uppercase tracking-widest text-stone-400 mb-3">Sourates â€” clique pour t'entraÃ®ner</h2>
    <div class="grid grid-cols-2 gap-3" id="home-surahs"></div>
</div>

<div id="tab-train" class="hidden px-4 pb-nav">
    <div id="surah-selector">
        <header class="pt-12 pb-5"><h1 class="playfair text-3xl font-bold" style="color:#3D2B2B">EntraÃ®ner ğŸ¯</h1></header>
        <p class="text-xs font-black uppercase tracking-widest text-stone-400 mb-3">Choisir une sourate</p>
        <div class="grid grid-cols-2 gap-3"></div>
    </div>
    <div id="session-view" class="hidden">
        <header class="pt-10 pb-4">
            <div class="flex justify-between items-center mb-3">
                <button onclick="window.backToSelector()" class="flex items-center gap-1.5 text-rose-500 font-bold text-sm"><i data-lucide="x" class="w-4 h-4"></i> ArrÃªter</button>
                <span id="sess-timer" class="text-stone-400 text-sm font-mono font-bold">00:00</span>
            </div>
            <div class="flex items-baseline gap-3">
                <h2 class="playfair text-2xl font-bold" style="color:#3D2B2B" id="sess-surah-name"></h2>
                <span class="amiri text-xl text-rose-400" id="sess-surah-ar"></span>
            </div>
            <div class="w-full bg-rose-100 rounded-full h-1.5 mt-4"><div id="sess-progress-bar" class="h-1.5 rounded-full bg-rose-400 transition-all" style="width:0%"></div></div>
        </header>
        <div class="bg-purple-50 rounded-2xl p-3 mb-4 border border-purple-100"><p class="text-xs text-purple-600" id="sess-tip"></p></div>
        <div class="card p-6 mb-4 fade-up">
            <p class="text-[10px] text-stone-400 uppercase font-black tracking-widest mb-4" id="sess-verse-num"></p>
            <p class="amiri text-3xl text-right leading-loose mb-5" style="color:#3D2B2B;" id="sess-verse-ar"></p>
            <div class="border-t border-stone-100 pt-4"><p class="text-sm text-stone-500 italic" id="sess-verse-tr"></p></div>
        </div>
        <p class="text-[10px] text-stone-400 uppercase font-black tracking-widest text-center mb-3">Comment tu as lu ce verset ?</p>
        <div class="grid grid-cols-3 gap-3 mb-6">
            <button onclick="window.rateVerse('easy')" class="rating-btn card p-4 text-center"><p class="text-2xl mb-1">âœ…</p><p class="text-xs font-bold text-emerald-600">Fluide</p></button>
            <button onclick="window.rateVerse('medium')" class="rating-btn card p-4 text-center"><p class="text-2xl mb-1">ğŸ”¸</p><p class="text-xs font-bold text-amber-500">Correct</p></button>
            <button onclick="window.rateVerse('hard')" class="rating-btn card p-4 text-center"><p class="text-2xl mb-1">â—</p><p class="text-xs font-bold text-rose-500">Difficile</p></button>
        </div>
    </div>
    <div id="result-view" class="hidden fade-up">
        <header class="pt-10 pb-5"><h1 class="playfair text-3xl font-bold" style="color:#3D2B2B">Session terminÃ©e ğŸ‰</h1></header>
        <button onclick="window.backToSelector()" class="w-full rose-btn p-4 text-center text-sm active:scale-95 transition-all">Retourner Ã  l'accueil</button>
    </div>
</div>

<div id="tab-arabic" class="hidden px-4 pb-nav">
    <header class="pt-12 pb-5 flex justify-between items-end">
        <div><h1 class="playfair text-3xl font-bold" style="color:#3D2B2B">Arabe ğŸ”¤</h1><p class="text-stone-400 text-sm mt-1">Apprends l'alphabet</p></div>
        <span id="letter-count" class="text-rose-500 font-black text-lg">0/28</span>
    </header>
    <div class="grid grid-cols-4 gap-2 mb-6" id="arabic-grid"></div>
</div>

<div id="tab-prophets" class="hidden px-4 pb-nav">
    <div id="prophets-list-view">
        <header class="pt-12 pb-5"><h1 class="playfair text-3xl font-bold" style="color:#3D2B2B">ProphÃ¨tes ï·º</h1><p class="text-stone-400 text-sm mt-1">Leurs 25 histoires</p></header>
        <div class="grid grid-cols-2 gap-3" id="prophets-grid"></div>
    </div>
    <div id="prophet-detail" class="hidden pb-4">
        <button onclick="window.backToProphets()" class="flex items-center gap-2 text-rose-500 font-bold text-sm pt-10 mb-5"><i data-lucide="arrow-left" class="w-4 h-4"></i> Retour</button>
        <div class="card p-6 mb-4">
            <p class="text-5xl mb-3" id="prophet-emoji"></p>
            <h2 class="playfair text-2xl font-bold" style="color:#3D2B2B" id="prophet-name-big"></h2>
            <p class="text-rose-400 text-sm font-medium mt-1" id="prophet-sub"></p>
        </div>
        <div class="card p-6"><p class="text-stone-600 text-sm leading-relaxed whitespace-pre-wrap" id="prophet-story"></p></div>
    </div>
</div>

<div id="tab-allah" class="hidden px-4 pb-nav">
    <header class="pt-12 pb-5 flex justify-between items-end">
        <div><h1 class="playfair text-3xl font-bold" style="color:#3D2B2B">Noms d'Allah ğŸŒ¿</h1><p class="text-stone-400 text-sm mt-1">Les 99 beaux noms</p></div>
        <span id="allah-count" class="text-emerald-500 font-black text-lg">0/99</span>
    </header>
    <div id="allah-names-list" class="space-y-2"></div>
</div>

<div id="tab-foundations" class="hidden px-4 pb-nav">
    <header class="pt-12 pb-5">
        <h1 class="playfair text-3xl font-bold" style="color:#3D2B2B">HÃ©ritage ğŸ•Œ</h1>
        <p class="text-stone-400 text-sm mt-1">RÃ©parer ton cÅ“ur, connaÃ®tre ton histoire</p>
    </header>

    <div class="flex gap-2 overflow-x-auto no-scrollbar pb-3 mb-4">
        <button onclick="window.showFoundSection('histoire')" id="fsec-histoire" class="flex-shrink-0 px-4 py-2 rounded-full text-xs font-black uppercase tracking-widest transition-all bg-rose-400 text-white">L'Histoire & HÃ©roÃ¯nes</button>
        <button onclick="window.showFoundSection('coeur')" id="fsec-coeur" class="flex-shrink-0 px-4 py-2 rounded-full text-xs font-black uppercase tracking-widest transition-all bg-white border text-stone-500">CÅ“ur & Foi</button>
        <button onclick="window.showFoundSection('ramadan')" id="fsec-ramadan" class="flex-shrink-0 px-4 py-2 rounded-full text-xs font-black uppercase tracking-widest transition-all bg-white border text-stone-500">Ramadan</button>
        <button onclick="window.showFoundSection('pratique')" id="fsec-pratique" class="flex-shrink-0 px-4 py-2 rounded-full text-xs font-black uppercase tracking-widest transition-all bg-white border text-stone-500">Pratique</button>
        <button onclick="window.showFoundSection('foi')" id="fsec-foi" class="flex-shrink-0 px-4 py-2 rounded-full text-xs font-black uppercase tracking-widest transition-all bg-white border text-stone-500">Dogme</button>
    </div>

    <div id="fsection-histoire" class="space-y-4">
        
        <div class="card p-5 bg-rose-50 border-rose-200">
            <h3 class="font-black text-rose-600 mb-2 flex items-center gap-2"><span class="text-xl">ğŸŒ¸</span> Les Grandes Femmes de l'Islam</h3>
            <p class="text-sm text-stone-600 mb-4">L'Islam n'aurait pas pu exister sans le courage, l'intelligence et la foi inÃ©branlable des femmes. Voici tes vrais modÃ¨les.</p>
            
            <div class="space-y-3">
                <details class="bg-white rounded-xl p-4 shadow-sm group cursor-pointer outline-none">
                    <summary class="font-bold text-stone-800 list-none flex justify-between">Khadija bint Khuwaylid (ra) <i data-lucide="chevron-down" class="w-4 h-4 text-stone-400 group-open:rotate-180 transition-transform"></i></summary>
                    <div class="mt-2 text-sm text-stone-600 leading-relaxed border-t pt-2">La premiÃ¨re Ã©pouse du ProphÃ¨te ï·º. Elle Ã©tait une riche femme d'affaires mecquoise. Quand le ProphÃ¨te ï·º a reÃ§u la premiÃ¨re rÃ©vÃ©lation, il Ã©tait terrifiÃ©. C'est elle qui l'a rassurÃ©, qui a cru en lui la premiÃ¨re, et qui a financÃ© l'Islam naissant. <b>LeÃ§on : L'indÃ©pendance, le soutien Ã©motionnel et l'intelligence.</b></div>
                </details>
                <details class="bg-white rounded-xl p-4 shadow-sm group cursor-pointer outline-none">
                    <summary class="font-bold text-stone-800 list-none flex justify-between">Aisha bint Abi Bakr (ra) <i data-lucide="chevron-down" class="w-4 h-4 text-stone-400 group-open:rotate-180 transition-transform"></i></summary>
                    <div class="mt-2 text-sm text-stone-600 leading-relaxed border-t pt-2">L'une des plus grandes savantes de l'histoire islamique. Elle a transmis plus de 2000 hadiths. Les plus grands compagnons (hommes) venaient lui demander des avis juridiques (fatwas). Elle maÃ®trisait la mÃ©decine, la poÃ©sie et la religion. <b>LeÃ§on : La quÃªte du savoir n'a pas de genre.</b></div>
                </details>
                <details class="bg-white rounded-xl p-4 shadow-sm group cursor-pointer outline-none">
                    <summary class="font-bold text-stone-800 list-none flex justify-between">Fatima az-Zahra (ra) <i data-lucide="chevron-down" class="w-4 h-4 text-stone-400 group-open:rotate-180 transition-transform"></i></summary>
                    <div class="mt-2 text-sm text-stone-600 leading-relaxed border-t pt-2">La fille bien-aimÃ©e du ProphÃ¨te ï·º. Elle a subi la pauvretÃ©, la faim et la persÃ©cution Ã  La Mecque. Quand les paÃ¯ens ont jetÃ© des ordures sur son pÃ¨re en priÃ¨re, c'est elle, encore enfant, qui est allÃ©e les retirer en pleurant. Elle est la "reine des femmes du Paradis". <b>LeÃ§on : La patience, la noblesse de caractÃ¨re face Ã  l'Ã©preuve.</b></div>
                </details>
                <details class="bg-white rounded-xl p-4 shadow-sm group cursor-pointer outline-none">
                    <summary class="font-bold text-stone-800 list-none flex justify-between">Maryam (Vierge Marie) <i data-lucide="chevron-down" class="w-4 h-4 text-stone-400 group-open:rotate-180 transition-transform"></i></summary>
                    <div class="mt-2 text-sm text-stone-600 leading-relaxed border-t pt-2">La seule femme citÃ©e nommÃ©ment dans le Coran, et toute une sourate porte son nom. AccusÃ©e Ã  tort par sa communautÃ© alors qu'elle venait d'enfanter Issa (JÃ©sus) seule sous un palmier, elle a gardÃ© le silence et a laissÃ© Allah la dÃ©fendre. <b>LeÃ§on : La dÃ©votion pure et la confiance absolue quand tout le monde est contre toi.</b></div>
                </details>
                <details class="bg-white rounded-xl p-4 shadow-sm group cursor-pointer outline-none">
                    <summary class="font-bold text-stone-800 list-none flex justify-between">Asiya bint Muzahim <i data-lucide="chevron-down" class="w-4 h-4 text-stone-400 group-open:rotate-180 transition-transform"></i></summary>
                    <div class="mt-2 text-sm text-stone-600 leading-relaxed border-t pt-2">La femme de Pharaon. Elle vivait dans le plus beau des palais avec l'homme le plus puissant (et tyran) de la terre. Pourtant, elle a secrÃ¨tement cru en Allah par le message de MÃ»sÃ¢ (MoÃ¯se). Elle a prÃ©fÃ©rÃ© la torture et la mort Ã  la mÃ©crÃ©ance dorÃ©e. <b>LeÃ§on : Ne jamais vendre sa foi pour le confort de ce monde.</b></div>
                </details>
            </div>
        </div>

        <div class="card p-5 bg-emerald-50 border-emerald-200">
            <h3 class="font-black text-emerald-600 mb-2 flex items-center gap-2"><span class="text-xl">ğŸ“œ</span> L'Ã‰popÃ©e de l'Islam</h3>
            <p class="text-sm text-stone-600 mb-4">ConnaÃ®tre ton histoire, c'est savoir d'oÃ¹ tu viens.</p>
            <div class="space-y-3">
                <details class="bg-white rounded-xl p-4 shadow-sm group cursor-pointer outline-none">
                    <summary class="font-bold text-stone-800 list-none flex justify-between">La pÃ©riode Mecquoise (Foi et RÃ©silience) <i data-lucide="chevron-down" class="w-4 h-4 text-stone-400 group-open:rotate-180 transition-transform"></i></summary>
                    <div class="mt-2 text-sm text-stone-600 leading-relaxed border-t pt-2">Pendant 13 ans, les musulmans ont Ã©tÃ© torturÃ©s, moquÃ©s et boycottÃ©s. Pas de combats, pas de lois complexes. Seulement une mission : forger le cÅ“ur sur le *Tawhid* (l'UnicitÃ©). Le Coran rÃ©vÃ©lÃ© Ã  cette Ã©poque parle surtout du Paradis, de l'Enfer et des anciens prophÃ¨tes pour rassurer.</div>
                </details>
                <details class="bg-white rounded-xl p-4 shadow-sm group cursor-pointer outline-none">
                    <summary class="font-bold text-stone-800 list-none flex justify-between">La pÃ©riode MÃ©dinoise (La SociÃ©tÃ©) <i data-lucide="chevron-down" class="w-4 h-4 text-stone-400 group-open:rotate-180 transition-transform"></i></summary>
                    <div class="mt-2 text-sm text-stone-600 leading-relaxed border-t pt-2">AprÃ¨s l'HÃ©gire (migration) vers MÃ©dine en 622, l'Islam devient un Ã‰tat. Les rÃ¨gles de la priÃ¨re, du jeÃ»ne, du commerce et du mariage sont rÃ©vÃ©lÃ©es. Les *Ansars* (habitants de MÃ©dine) partagent littÃ©ralement la moitiÃ© de leurs richesses avec les *Muhajirun* (rÃ©fugiÃ©s de La Mecque). C'est la naissance de l'Oumma (communautÃ©).</div>
                </details>
                <details class="bg-white rounded-xl p-4 shadow-sm group cursor-pointer outline-none">
                    <summary class="font-bold text-stone-800 list-none flex justify-between">Les 4 Califes Bien GuidÃ©s <i data-lucide="chevron-down" class="w-4 h-4 text-stone-400 group-open:rotate-180 transition-transform"></i></summary>
                    <div class="mt-2 text-sm text-stone-600 leading-relaxed border-t pt-2">
                        AprÃ¨s la mort du ProphÃ¨te ï·º, quatre de ses plus proches amis ont dirigÃ© la communautÃ© :<br><br>
                        1. <b>Abou Bakr As-Siddiq</b> : Le VÃ©ridique, qui a maintenu l'unitÃ© de l'Islam Ã  la mort du ProphÃ¨te.<br>
                        2. <b>Omar Ibn Al-Khattab</b> : Le Juste, sous qui l'Islam s'est rÃ©pandu de la Perse Ã  l'Ã‰gypte.<br>
                        3. <b>Othman Ibn Affan</b> : Le Pudique, le gÃ©nÃ©reux qui a compilÃ© le Coran en un seul livre officiel.<br>
                        4. <b>Ali Ibn Abi Talib</b> : Le Sage, cousin et gendre du ProphÃ¨te, connu pour son Ã©loquence et son courage spirituel.
                    </div>
                </details>
            </div>
        </div>
    </div>

    <div id="fsection-coeur" class="hidden space-y-4">
        <div class="card p-5 border-rose-300 shadow-sm">
            <h3 class="font-black text-rose-600 mb-2 flex items-center gap-2"><span class="text-xl">ğŸ’”</span> Quand la foi baisse...</h3>
            <p class="text-sm text-stone-600 mb-4">C'est normal. Ne culpabilise pas Ã  t'en rendre malade. Le ProphÃ¨te ï·º a dit : "La foi s'use dans votre cÅ“ur comme s'use un vÃªtement. Demandez donc Ã  Allah de la renouveler."</p>
            
            <h4 class="font-bold text-stone-800 text-xs uppercase tracking-widest mb-2 mt-4">Les symptÃ´mes</h4>
            <ul class="text-sm text-stone-600 list-disc pl-4 space-y-1 mb-4">
                <li>Retarder la priÃ¨re Ã  la derniÃ¨re minute.</li>
                <li>Le cÅ“ur dur : tu lis le Coran ou tu entends un rappel, et tu ne ressens rien.</li>
                <li>Faire des pÃ©chÃ©s en cachette plus facilement qu'avant.</li>
            </ul>

            <h4 class="font-bold text-stone-800 text-xs uppercase tracking-widest mb-2 mt-4">Les remÃ¨des (Tazkiyat an-Nafs)</h4>
            <div class="space-y-3">
                <div class="bg-rose-50 p-3 rounded-xl border border-rose-100">
                    <p class="font-bold text-rose-600 text-sm">1. L'Istighfar (Demander pardon)</p>
                    <p class="text-xs text-stone-600 mt-1">Dis "Astaghfirullah" le plus souvent possible. Les pÃ©chÃ©s sont des taches noires sur le cÅ“ur ; l'Istighfar le nettoie.</p>
                </div>
                <div class="bg-rose-50 p-3 rounded-xl border border-rose-100">
                    <p class="font-bold text-rose-600 text-sm">2. Chercher le Khushu' (La concentration)</p>
                    <p class="text-xs text-stone-600 mt-1">Si ta priÃ¨re te semble mÃ©canique, ralentis. Prends 5 secondes de pause entre chaque mouvement. Imagine qu'Allah te regarde droit dans le cÅ“ur.</p>
                </div>
                <div class="bg-rose-50 p-3 rounded-xl border border-rose-100">
                    <p class="font-bold text-rose-600 text-sm">3. Les actions cachÃ©es</p>
                    <p class="text-xs text-stone-600 mt-1">Fais une aumÃ´ne secrÃ¨te, prie 2 unitÃ©s la nuit sans le dire Ã  personne, ou fais des invocations pour quelqu'un. Le secret tue l'orgueil et nourrit l'amour d'Allah.</p>
                </div>
            </div>
        </div>
    </div>

    <div id="fsection-ramadan" class="hidden space-y-4">
        <div class="card p-5 bg-amber-50 border-amber-200">
            <h3 class="font-black text-amber-600 mb-2 flex items-center gap-2"><span class="text-xl">ğŸŒ™</span> Ton Objectif Ramadan</h3>
            <p class="text-sm text-stone-600 mb-4">Le Ramadan n'est pas fait pour te frustrer. Il est lÃ  pour te rÃ©parer. L'imam Al-Ghazali expliquait qu'il y a 3 niveaux de jeÃ»ne. Lequel veux-tu atteindre ?</p>
            
            <div class="space-y-3">
                <div class="bg-white p-4 rounded-xl shadow-sm border border-stone-100">
                    <p class="font-bold text-amber-600 text-sm">Niveau 1 : Le jeÃ»ne du ventre</p>
                    <p class="text-xs text-stone-600 mt-1">C'est la base. Tu ne manges pas, tu ne bois pas. C'est valide, mais c'est le strict minimum.</p>
                </div>
                <div class="bg-white p-4 rounded-xl shadow-sm border border-stone-100">
                    <p class="font-bold text-amber-600 text-sm">Niveau 2 : Le jeÃ»ne des membres</p>
                    <p class="text-xs text-stone-600 mt-1">Ton ventre jeÃ»ne, mais tes yeux, tes oreilles et ta langue jeÃ»nent aussi. Tu ne regardes pas de mauvaises choses, tu ne mÃ©dis pas, tu ne te disputes pas. Tu gardes ton calme.</p>
                </div>
                <div class="bg-amber-100 p-4 rounded-xl shadow-sm border border-amber-300 relative overflow-hidden">
                    <div class="absolute -right-4 -bottom-4 text-6xl opacity-20">âœ¨</div>
                    <p class="font-black text-amber-700 text-sm">Niveau 3 : Le jeÃ»ne du cÅ“ur</p>
                    <p class="text-xs text-amber-900 mt-1">Le niveau ultime. Ton cÅ“ur se dÃ©tache des prÃ©occupations mondaines. Tu ne penses qu'Ã  te rapprocher d'Allah. Ta prÃ©occupation n'est pas "qu'est-ce qu'on mange ce soir", mais "comment vais-je prier Taraweeh".</p>
                </div>
            </div>
            
            <p class="text-sm text-stone-600 italic mt-4 text-center">Fais de ce Ramadan celui du renouveau, mÃªme si ta foi part de loin.</p>
        </div>
    </div>

    <div id="fsection-pratique" class="hidden space-y-3">
        <details class="card overflow-hidden group" open><summary class="p-5 flex gap-4 cursor-pointer outline-none"><div class="w-10 h-10 rounded-2xl flex items-center justify-center font-black text-white text-lg bg-rose-400">1</div><div class="flex-1"><p class="font-bold text-stone-800">La Shahada</p><p class="text-xs text-stone-400">L'Attestation de foi</p></div></summary><div class="px-5 pb-5 border-t pt-4 text-sm text-stone-500 leading-relaxed">"Ach-hadu an la ilaha illallah, wa ach-hadu anna Muhammadan rasulullah". C'est l'essence de l'Islam. Elle remet de l'ordre dans ton cÅ“ur : rien ne mÃ©rite d'Ãªtre craint ni adorÃ© Ã  part Allah.</div></details>
        <details class="card overflow-hidden group"><summary class="p-5 flex gap-4 cursor-pointer outline-none"><div class="w-10 h-10 rounded-2xl flex items-center justify-center font-black text-white text-lg bg-rose-400">2</div><div class="flex-1"><p class="font-bold text-stone-800">La SalÃ¢t</p><p class="text-xs text-stone-400">Les 5 priÃ¨res (Fajr, Dohr, Asr, Maghrib, Isha)</p></div></summary><div class="px-5 pb-5 border-t pt-4 text-sm text-stone-500 leading-relaxed">Le premier acte jugÃ©. Ne la lÃ¢che jamais, mÃªme si tu fais des erreurs Ã  cÃ´tÃ©. La priÃ¨re t'empÃªchera de sombrer. C'est l'oxygÃ¨ne de ton Ã¢me.</div></details>
        <details class="card overflow-hidden group"><summary class="p-5 flex gap-4 cursor-pointer outline-none"><div class="w-10 h-10 rounded-2xl flex items-center justify-center font-black text-white text-lg bg-rose-400">3</div><div class="flex-1"><p class="font-bold text-stone-800">La ZakÃ¢t</p><p class="text-xs text-stone-400">L'aumÃ´ne purificatrice</p></div></summary><div class="px-5 pb-5 border-t pt-4 text-sm text-stone-500 leading-relaxed">Obligatoire pour purifier tes biens (2,5% de l'Ã©pargne). Elle rappelle que tout ce que tu as vient d'Allah.</div></details>
        <details class="card overflow-hidden group"><summary class="p-5 flex gap-4 cursor-pointer outline-none"><div class="w-10 h-10 rounded-2xl flex items-center justify-center font-black text-white text-lg bg-rose-400">4</div><div class="flex-1"><p class="font-bold text-stone-800">Le Sawm</p><p class="text-xs text-stone-400">JeÃ»ner le Ramadan</p></div></summary><div class="px-5 pb-5 border-t pt-4 text-sm text-stone-500 leading-relaxed">L'Ã©cole de la maÃ®trise de soi. Tu prouves Ã  ton corps que ton Ã¢me est aux commandes.</div></details>
        <details class="card overflow-hidden group"><summary class="p-5 flex gap-4 cursor-pointer outline-none"><div class="w-10 h-10 rounded-2xl flex items-center justify-center font-black text-white text-lg bg-rose-400">5</div><div class="flex-1"><p class="font-bold text-stone-800">Le Hajj</p><p class="text-xs text-stone-400">Le grand pÃ¨lerinage</p></div></summary><div class="px-5 pb-5 border-t pt-4 text-sm text-stone-500 leading-relaxed">Ã€ faire au moins une fois si on en a les moyens physiques et financiers. Tous vÃªtus de blanc, Ã©gaux devant Dieu, comme le Jour du Jugement.</div></details>
    </div>

    <div id="fsection-foi" class="hidden space-y-3">
        <p class="text-xs font-black uppercase tracking-widest text-stone-400 mb-3 px-2">Les 6 Piliers de la Foi (Al-Iman)</p>
        <div class="card p-4 flex gap-3 items-center"><div class="w-8 h-8 rounded-xl flex items-center justify-center text-white bg-indigo-400 flex-shrink-0">1</div><div><p class="font-bold text-sm text-stone-800">En Allah</p><p class="text-xs text-stone-500">UnicitÃ© absolue.</p></div></div>
        <div class="card p-4 flex gap-3 items-center"><div class="w-8 h-8 rounded-xl flex items-center justify-center text-white bg-indigo-400 flex-shrink-0">2</div><div><p class="font-bold text-sm text-stone-800">Aux Anges</p><p class="text-xs text-stone-500">CrÃ©atures de lumiÃ¨re pures.</p></div></div>
        <div class="card p-4 flex gap-3 items-center"><div class="w-8 h-8 rounded-xl flex items-center justify-center text-white bg-indigo-400 flex-shrink-0">3</div><div><p class="font-bold text-sm text-stone-800">Aux Livres</p><p class="text-xs text-stone-500">Torah, Psaumes, Ã‰vangile, et le Coran prÃ©servÃ©.</p></div></div>
        <div class="card p-4 flex gap-3 items-center"><div class="w-8 h-8 rounded-xl flex items-center justify-center text-white bg-indigo-400 flex-shrink-0">4</div><div><p class="font-bold text-sm text-stone-800">Aux Messagers</p><p class="text-xs text-stone-500">De Adam ï·º Ã  Muhammad ï·º.</p></div></div>
        <div class="card p-4 flex gap-3 items-center"><div class="w-8 h-8 rounded-xl flex items-center justify-center text-white bg-indigo-400 flex-shrink-0">5</div><div><p class="font-bold text-sm text-stone-800">Au Jour Dernier</p><p class="text-xs text-stone-500">La justice et le jugement final.</p></div></div>
        <div class="card p-4 flex gap-3 items-center"><div class="w-8 h-8 rounded-xl flex items-center justify-center text-white bg-indigo-400 flex-shrink-0">6</div><div><p class="font-bold text-sm text-stone-800">Au Destin (Qadar)</p><p class="text-xs text-stone-500">Dieu sait, Ã©crit, veut et crÃ©e tout ce qui arrive.</p></div></div>
    </div>
</div>

<div id="tab-duas" class="hidden px-4 pb-nav">
    <header class="pt-12 pb-5"><h1 class="playfair text-3xl font-bold" style="color:#3D2B2B">Duas ğŸ¤²</h1><p class="text-stone-400 text-sm mt-1">L'arme du croyant</p></header>

    <div class="card p-5 mb-4">
        <h2 class="text-xs font-black uppercase tracking-widest text-indigo-500 mb-2">Mes duas personnelles</h2>
        <input id="dua-title-inp" placeholder="Titre (ex: Pour ma mÃ¨re...)" class="w-full rounded-xl px-4 py-3 text-sm outline-none mb-2 border bg-[#FDF8F3]">
        <textarea id="dua-text-inp" rows="3" placeholder="Ta dua..." class="w-full rounded-xl px-4 py-3 text-sm outline-none mb-3 resize-none border bg-[#FDF8F3]"></textarea>
        <button onclick="window.addDua()" class="w-full bg-indigo-500 text-white rounded-xl py-3 text-sm font-bold active:scale-95 transition-all">Sauvegarder ma dua</button>
    </div>
    
    <div id="personal-duas-list" class="space-y-3 mb-6"></div>

    <h2 class="text-xs font-black uppercase tracking-widest text-rose-500 mb-3">Duas fondamentales</h2>
    <div class="space-y-3">
        <details class="card p-5 group"><summary class="font-bold text-sm text-stone-800 outline-none cursor-pointer flex justify-between">ğŸ‹ Dua de YÃ»nus <i data-lucide="chevron-down" class="w-4 h-4 text-stone-400 group-open:rotate-180 transition-transform"></i></summary><div class="mt-3 border-t pt-3"><p class="amiri text-2xl text-rose-500 text-right">Ù„ÙÙ‘Ø§ Ø¥ÙÙ„ÙÙ°Ù‡Ù Ø¥ÙÙ„ÙÙ‘Ø§ Ø£ÙÙ†ØªÙ Ø³ÙØ¨Ù’Ø­ÙØ§Ù†ÙÙƒÙ Ø¥ÙÙ†ÙÙ‘ÙŠ ÙƒÙÙ†ØªÙ Ù…ÙÙ†Ù Ø§Ù„Ø¸ÙÙ‘Ø§Ù„ÙÙ…ÙÙŠÙ†Ù</p><p class="text-sm text-stone-600 mt-2">"Il n'y a de dieu que Toi, Gloire Ã  Toi, j'ai Ã©tÃ© parmi les injustes."</p></div></details>
        <details class="card p-5 group"><summary class="font-bold text-sm text-stone-800 outline-none cursor-pointer flex justify-between">âœ¨ Dua Laylat al-Qadr <i data-lucide="chevron-down" class="w-4 h-4 text-stone-400 group-open:rotate-180 transition-transform"></i></summary><div class="mt-3 border-t pt-3"><p class="amiri text-2xl text-rose-500 text-right">Ø§Ù„Ù„ÙÙ‘Ù‡ÙÙ…ÙÙ‘ Ø¥ÙÙ†ÙÙ‘ÙƒÙ Ø¹ÙÙÙÙˆÙŒÙ‘ ØªÙØ­ÙØ¨ÙÙ‘ Ø§Ù„Ù’Ø¹ÙÙÙ’ÙˆÙ ÙÙØ§Ø¹Ù’ÙÙ Ø¹ÙÙ†ÙÙ‘ÙŠ</p><p class="text-sm text-stone-600 mt-2">"Ã” Allah, Tu es l'Indulgent, Tu aimes l'indulgence, sois indulgent envers moi."</p></div></details>
        <details class="card p-5 group"><summary class="font-bold text-sm text-stone-800 outline-none cursor-pointer flex justify-between">ğŸŒŠ Dua de l'anxiÃ©tÃ© <i data-lucide="chevron-down" class="w-4 h-4 text-stone-400 group-open:rotate-180 transition-transform"></i></summary><div class="mt-3 border-t pt-3"><p class="amiri text-2xl text-rose-500 text-right">Ø§Ù„Ù„ÙÙ‘Ù‡ÙÙ…ÙÙ‘ Ø¥ÙÙ†ÙÙ‘ÙŠ Ø£ÙØ¹ÙÙˆØ°Ù Ø¨ÙÙƒÙ Ù…ÙÙ†Ù Ø§Ù„Ù’Ù‡ÙÙ…ÙÙ‘ ÙˆÙØ§Ù„Ù’Ø­ÙØ²ÙÙ†Ù</p><p class="text-sm text-stone-600 mt-2">"Ã” Allah, je cherche refuge en Toi contre l'inquiÃ©tude et la tristesse."</p></div></details>
    </div>
</div>

<nav class="fixed bottom-0 left-0 right-0 z-50 border-t overflow-x-auto no-scrollbar" style="background:rgba(253,248,243,0.95);border-color:#F0D8D8;backdrop-filter:blur(20px)">
    <div class="flex justify-between items-center py-2 px-1 min-w-max mx-auto" style="gap:4px">
        <button id="nav-home" onclick="window.showTab('home')" class="active-nav flex flex-col items-center gap-0.5 px-3 py-1.5 min-w-[52px]">
            <i data-lucide="home" class="nav-icon w-5 h-5 text-stone-400"></i><span class="nav-label text-[9px] font-black text-stone-400 uppercase tracking-widest">Accueil</span>
        </button>
        <button id="nav-train" onclick="window.showTab('train')" class="flex flex-col items-center gap-0.5 px-3 py-1.5 min-w-[52px]">
            <i data-lucide="mic" class="nav-icon w-5 h-5 text-stone-400"></i><span class="nav-label text-[9px] font-black text-stone-400 uppercase tracking-widest">FluiditÃ©</span>
        </button>
        <button id="nav-arabic" onclick="window.showTab('arabic')" class="flex flex-col items-center gap-0.5 px-3 py-1.5 min-w-[52px]">
            <i data-lucide="type" class="nav-icon w-5 h-5 text-stone-400"></i><span class="nav-label text-[9px] font-black text-stone-400 uppercase tracking-widest">Arabe</span>
        </button>
        <button id="nav-prophets" onclick="window.showTab('prophets')" class="flex flex-col items-center gap-0.5 px-3 py-1.5 min-w-[52px]">
            <i data-lucide="stars" class="nav-icon w-5 h-5 text-stone-400"></i><span class="nav-label text-[9px] font-black text-stone-400 uppercase tracking-widest">ProphÃ¨tes</span>
        </button>
        <button id="nav-allah" onclick="window.showTab('allah')" class="flex flex-col items-center gap-0.5 px-3 py-1.5 min-w-[52px]">
            <i data-lucide="heart" class="nav-icon w-5 h-5 text-stone-400"></i><span class="nav-label text-[9px] font-black text-stone-400 uppercase tracking-widest">99 Noms</span>
        </button>
        <button id="nav-foundations" onclick="window.showTab('foundations')" class="flex flex-col items-center gap-0.5 px-3 py-1.5 min-w-[52px]">
            <i data-lucide="landmark" class="nav-icon w-5 h-5 text-stone-400"></i><span class="nav-label text-[9px] font-black text-stone-400 uppercase tracking-widest">HÃ©ritage</span>
        </button>
        <button id="nav-duas" onclick="window.showTab('duas')" class="flex flex-col items-center gap-0.5 px-3 py-1.5 min-w-[52px]">
            <i data-lucide="hand" class="nav-icon w-5 h-5 text-stone-400"></i><span class="nav-label text-[9px] font-black text-stone-400 uppercase tracking-widest">Duas</span>
        </button>
    </div>
</nav>

</div>
</body>
</html>
